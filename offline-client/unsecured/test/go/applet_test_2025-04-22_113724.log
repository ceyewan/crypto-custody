2025/04/22 11:37:24.771860 === 安全芯片Applet测试开始 - 2025-04-22 11:37:24 ===
2025/04/22 11:37:24.798053 使用读卡器: GOODIX GSE SmartCard Reader 01
2025/04/22 11:37:24.858658 成功连接到读卡器，使用协议: 2
2025/04/22 11:37:24.858728 
=== 选择Applet命令 ===
2025/04/22 11:37:24.858742 APDU: 00A4040008A000000062CF0101
2025/04/22 11:37:24.858748 命令解析:
2025/04/22 11:37:24.858753   CLA: 0x00 (ISO标准命令)
2025/04/22 11:37:24.858757   INS: 0xA4 (选择指令)
2025/04/22 11:37:24.858762   P1: 0x04 (按名称选择)
2025/04/22 11:37:24.858767   P2: 0x00 (首次选择)
2025/04/22 11:37:24.858771   Lc: 0x08 (AID长度)
2025/04/22 11:37:24.858776   Data: A000000062CF0101 (AID)
2025/04/22 11:37:24.860786 
=== 选择Applet响应 ===
2025/04/22 11:37:24.860804 响应数据: 9000
2025/04/22 11:37:24.860811 状态码: 0x9000 (成功)
2025/04/22 11:37:24.860817 数据: 
2025/04/22 11:37:24.860823 成功选择Applet, AID: A000000062CF0101
2025/04/22 11:37:24.860838 

=== 测试1: 存储多条消息 ===
2025/04/22 11:37:24.860849 
>> 存储消息 #1: 基本消息测试
2025/04/22 11:37:24.860853    用户名: User1
2025/04/22 11:37:24.860858    地址: Beijing Haidian
2025/04/22 11:37:24.860862    消息长度: 81字节
2025/04/22 11:37:24.860867 
=== 存储初始化命令 ===
2025/04/22 11:37:24.860895 APDU: 80100000160555736572310F4265696A696E67204861696469616E
2025/04/22 11:37:24.860899 命令解析:
2025/04/22 11:37:24.860903   CLA: 0x80 (命令类)
2025/04/22 11:37:24.860907   INS: 0x10 (存储初始化指令)
2025/04/22 11:37:24.860912   P1: 0x00
2025/04/22 11:37:24.860916   P2: 0x00
2025/04/22 11:37:24.860920   Lc: 0x16 (数据长度=22)
2025/04/22 11:37:24.860924   Data: 0555736572310F4265696A696E67204861696469616E
2025/04/22 11:37:24.860928     用户名长度: 0x05 (5)
2025/04/22 11:37:24.860933     用户名: 5573657231 (User1)
2025/04/22 11:37:24.860938     地址长度: 0x0F (15)
2025/04/22 11:37:24.860942     地址: 4265696A696E67204861696469616E (Beijing Haidian)
2025/04/22 11:37:24.896962 
=== 存储初始化响应 ===
2025/04/22 11:37:24.897025 响应数据: 0202050F90009000
2025/04/22 11:37:24.897049 状态码: 0x9000 (成功)
2025/04/22 11:37:24.897056 响应解析:
2025/04/22 11:37:24.897061   记录索引: 0x02 (2)
2025/04/22 11:37:24.897067   当前记录总数: 0x02 (2)
2025/04/22 11:37:24.897071   用户名长度: 0x05 (5)
2025/04/22 11:37:24.897076   地址长度: 0x0F (15)
2025/04/22 11:37:24.897081 
传输消息数据:
2025/04/22 11:37:24.897085 总长度: 81 字节
2025/04/22 11:37:24.897089 分块大小: 200 字节
2025/04/22 11:37:24.897094 预计分块数: 1
2025/04/22 11:37:24.897098 
=== 存储数据继续命令 (块 1/1) ===
2025/04/22 11:37:24.897103 APDU: 8011000051546869732069732074686520666972...(显示前20字节)
2025/04/22 11:37:24.897107 命令解析:
2025/04/22 11:37:24.897111   CLA: 0x80 (命令类)
2025/04/22 11:37:24.897116   INS: 0x11 (存储继续指令)
2025/04/22 11:37:24.897120   P1: 0x00
2025/04/22 11:37:24.897124   P2: 0x00
2025/04/22 11:37:24.897128   Lc: 0x51 (数据块长度=81)
2025/04/22 11:37:24.897132   Data: 5468697320697320746865206669727374207465...(数据块太长，只显示前20字节)
2025/04/22 11:37:24.919760 
=== 存储数据继续响应 ===
2025/04/22 11:37:24.919796 响应数据: 020051005190009000
2025/04/22 11:37:24.919806 状态码: 0x9000 (成功)
2025/04/22 11:37:24.919814 响应解析:
2025/04/22 11:37:24.919820   记录索引: 0x02 (2)
2025/04/22 11:37:24.919826   当前偏移: 0x0051 (81)
2025/04/22 11:37:24.919832   块大小: 0x0051 (81)
2025/04/22 11:37:24.919868 进度: 81/81 字节 (100.0%)
2025/04/22 11:37:24.919878 
=== 存储完成命令 ===
2025/04/22 11:37:24.919884 APDU: 8012000000
2025/04/22 11:37:24.919890 命令解析:
2025/04/22 11:37:24.919894   CLA: 0x80 (命令类)
2025/04/22 11:37:24.919899   INS: 0x12 (存储完成指令)
2025/04/22 11:37:24.919908   P1: 0x00
2025/04/22 11:37:24.919913   P2: 0x00
2025/04/22 11:37:24.919918   Lc: 0x00 (无数据)
2025/04/22 11:37:24.948185 
=== 存储完成响应 ===
2025/04/22 11:37:24.948249 响应数据: 0200510290009000
2025/04/22 11:37:24.948259 状态码: 0x9000 (成功)
2025/04/22 11:37:24.948265 响应解析:
2025/04/22 11:37:24.948270   记录索引: 0x02 (2)
2025/04/22 11:37:24.948275   最终长度: 0x0051 (81字节)
2025/04/22 11:37:24.948280   新记录总数: 0x02 (2)
2025/04/22 11:37:24.948284 === 存储操作成功完成 ===
2025/04/22 11:37:24.948325 
>> 存储消息 #2: 相同用户名和地址的覆盖测试
2025/04/22 11:37:24.948339    用户名: User1
2025/04/22 11:37:24.948345    地址: Beijing Haidian
2025/04/22 11:37:24.948350    消息长度: 73字节
2025/04/22 11:37:24.948356 
=== 存储初始化命令 ===
2025/04/22 11:37:24.948360 APDU: 80100000160555736572310F4265696A696E67204861696469616E
2025/04/22 11:37:24.948377 命令解析:
2025/04/22 11:37:24.948461   CLA: 0x80 (命令类)
2025/04/22 11:37:24.948480   INS: 0x10 (存储初始化指令)
2025/04/22 11:37:24.948487   P1: 0x00
2025/04/22 11:37:24.948492   P2: 0x00
2025/04/22 11:37:24.948497   Lc: 0x16 (数据长度=22)
2025/04/22 11:37:24.948502   Data: 0555736572310F4265696A696E67204861696469616E
2025/04/22 11:37:24.948509     用户名长度: 0x05 (5)
2025/04/22 11:37:24.948514     用户名: 5573657231 (User1)
2025/04/22 11:37:24.948518     地址长度: 0x0F (15)
2025/04/22 11:37:24.948522     地址: 4265696A696E67204861696469616E (Beijing Haidian)
2025/04/22 11:37:24.981818 
=== 存储初始化响应 ===
2025/04/22 11:37:24.981883 响应数据: 0303050F90009000
2025/04/22 11:37:24.981893 状态码: 0x9000 (成功)
2025/04/22 11:37:24.981900 响应解析:
2025/04/22 11:37:24.981904   记录索引: 0x03 (3)
2025/04/22 11:37:24.981912   当前记录总数: 0x03 (3)
2025/04/22 11:37:24.981916   用户名长度: 0x05 (5)
2025/04/22 11:37:24.981920   地址长度: 0x0F (15)
2025/04/22 11:37:24.981925 
传输消息数据:
2025/04/22 11:37:24.981928 总长度: 73 字节
2025/04/22 11:37:24.981932 分块大小: 200 字节
2025/04/22 11:37:24.981935 预计分块数: 1
2025/04/22 11:37:24.981939 
=== 存储数据继续命令 (块 1/1) ===
2025/04/22 11:37:24.981943 APDU: 8011000049546869732069732061206469666665...(显示前20字节)
2025/04/22 11:37:24.981947 命令解析:
2025/04/22 11:37:24.981950   CLA: 0x80 (命令类)
2025/04/22 11:37:24.981954   INS: 0x11 (存储继续指令)
2025/04/22 11:37:24.981957   P1: 0x00
2025/04/22 11:37:24.981961   P2: 0x00
2025/04/22 11:37:24.981964   Lc: 0x49 (数据块长度=73)
2025/04/22 11:37:24.981968   Data: 54686973206973206120646966666572656E7420...(数据块太长，只显示前20字节)
2025/04/22 11:37:25.003623 
=== 存储数据继续响应 ===
2025/04/22 11:37:25.003644 响应数据: 030049004990009000
2025/04/22 11:37:25.003651 状态码: 0x9000 (成功)
2025/04/22 11:37:25.003657 响应解析:
2025/04/22 11:37:25.003661   记录索引: 0x03 (3)
2025/04/22 11:37:25.003666   当前偏移: 0x0049 (73)
2025/04/22 11:37:25.003671   块大小: 0x0049 (73)
2025/04/22 11:37:25.003676 进度: 73/73 字节 (100.0%)
2025/04/22 11:37:25.003684 
=== 存储完成命令 ===
2025/04/22 11:37:25.003688 APDU: 8012000000
2025/04/22 11:37:25.003692 命令解析:
2025/04/22 11:37:25.003696   CLA: 0x80 (命令类)
2025/04/22 11:37:25.003722   INS: 0x12 (存储完成指令)
2025/04/22 11:37:25.003726   P1: 0x00
2025/04/22 11:37:25.003731   P2: 0x00
2025/04/22 11:37:25.003735   Lc: 0x00 (无数据)
2025/04/22 11:37:25.032171 
=== 存储完成响应 ===
2025/04/22 11:37:25.032254 响应数据: 0300490390009000
2025/04/22 11:37:25.032287 状态码: 0x9000 (成功)
2025/04/22 11:37:25.032307 响应解析:
2025/04/22 11:37:25.032320   记录索引: 0x03 (3)
2025/04/22 11:37:25.032335   最终长度: 0x0049 (73字节)
2025/04/22 11:37:25.032351   新记录总数: 0x03 (3)
2025/04/22 11:37:25.032363 === 存储操作成功完成 ===
2025/04/22 11:37:25.032470 
>> 存储消息 #3: 中等长度消息测试(512字节)
2025/04/22 11:37:25.032509    用户名: User2
2025/04/22 11:37:25.032529    地址: Shanghai Pudong
2025/04/22 11:37:25.032543    消息长度: 512字节
2025/04/22 11:37:25.032555 
=== 存储初始化命令 ===
2025/04/22 11:37:25.032599 APDU: 80100000160555736572320F5368616E67686169205075646F6E67
2025/04/22 11:37:25.032614 命令解析:
2025/04/22 11:37:25.032626   CLA: 0x80 (命令类)
2025/04/22 11:37:25.032635   INS: 0x10 (存储初始化指令)
2025/04/22 11:37:25.032645   P1: 0x00
2025/04/22 11:37:25.032654   P2: 0x00
2025/04/22 11:37:25.032662   Lc: 0x16 (数据长度=22)
2025/04/22 11:37:25.032671   Data: 0555736572320F5368616E67686169205075646F6E67
2025/04/22 11:37:25.032680     用户名长度: 0x05 (5)
2025/04/22 11:37:25.032690     用户名: 5573657232 (User2)
2025/04/22 11:37:25.032700     地址长度: 0x0F (15)
2025/04/22 11:37:25.032707     地址: 5368616E67686169205075646F6E67 (Shanghai Pudong)
2025/04/22 11:37:25.066132 
=== 存储初始化响应 ===
2025/04/22 11:37:25.066154 响应数据: 0404050F90009000
2025/04/22 11:37:25.066159 状态码: 0x9000 (成功)
2025/04/22 11:37:25.066164 响应解析:
2025/04/22 11:37:25.066168   记录索引: 0x04 (4)
2025/04/22 11:37:25.066173   当前记录总数: 0x04 (4)
2025/04/22 11:37:25.066177   用户名长度: 0x05 (5)
2025/04/22 11:37:25.066192   地址长度: 0x0F (15)
2025/04/22 11:37:25.066199 
传输消息数据:
2025/04/22 11:37:25.066203 总长度: 512 字节
2025/04/22 11:37:25.066207 分块大小: 200 字节
2025/04/22 11:37:25.066212 预计分块数: 3
2025/04/22 11:37:25.066221 
=== 存储数据继续命令 (块 1/3) ===
2025/04/22 11:37:25.066226 APDU: 80110000C8414141414141414141414141414141...(显示前20字节)
2025/04/22 11:37:25.066230 命令解析:
2025/04/22 11:37:25.066234   CLA: 0x80 (命令类)
2025/04/22 11:37:25.066238   INS: 0x11 (存储继续指令)
2025/04/22 11:37:25.066259   P1: 0x00
2025/04/22 11:37:25.066263   P2: 0x00
2025/04/22 11:37:25.066267   Lc: 0xC8 (数据块长度=200)
2025/04/22 11:37:25.066271   Data: 4141414141414141414141414141414141414141...(数据块太长，只显示前20字节)
2025/04/22 11:37:25.088601 
=== 存储数据继续响应 ===
2025/04/22 11:37:25.088700 响应数据: 0400C800C890009000
2025/04/22 11:37:25.088857 状态码: 0x9000 (成功)
2025/04/22 11:37:25.088876 响应解析:
2025/04/22 11:37:25.088889   记录索引: 0x04 (4)
2025/04/22 11:37:25.088903   当前偏移: 0x00C8 (200)
2025/04/22 11:37:25.088913   块大小: 0x00C8 (200)
2025/04/22 11:37:25.088924 进度: 200/512 字节 (39.1%)
2025/04/22 11:37:25.088941 
=== 存储数据继续命令 (块 2/3) ===
2025/04/22 11:37:25.088951 APDU: 80110000C8414141414141414141414141414141...(显示前20字节)
2025/04/22 11:37:25.088960 命令解析:
2025/04/22 11:37:25.088968   CLA: 0x80 (命令类)
2025/04/22 11:37:25.088976   INS: 0x11 (存储继续指令)
2025/04/22 11:37:25.088987   P1: 0x00
2025/04/22 11:37:25.088996   P2: 0x00
2025/04/22 11:37:25.089004   Lc: 0xC8 (数据块长度=200)
2025/04/22 11:37:25.089014   Data: 4141414141414141414141414141414141414141...(数据块太长，只显示前20字节)
2025/04/22 11:37:25.113521 
=== 存储数据继续响应 ===
2025/04/22 11:37:25.113653 响应数据: 04019000C890009000
2025/04/22 11:37:25.113702 状态码: 0x9000 (成功)
2025/04/22 11:37:25.113723 响应解析:
2025/04/22 11:37:25.113734   记录索引: 0x04 (4)
2025/04/22 11:37:25.113748   当前偏移: 0x0190 (400)
2025/04/22 11:37:25.113762   块大小: 0x00C8 (200)
2025/04/22 11:37:25.113776 进度: 400/512 字节 (78.1%)
2025/04/22 11:37:25.113820 
=== 存储数据继续命令 (块 3/3) ===
2025/04/22 11:37:25.113842 APDU: 8011000070414141414141414141414141414141...(显示前20字节)
2025/04/22 11:37:25.113854 命令解析:
2025/04/22 11:37:25.113864   CLA: 0x80 (命令类)
2025/04/22 11:37:25.113875   INS: 0x11 (存储继续指令)
2025/04/22 11:37:25.113885   P1: 0x00
2025/04/22 11:37:25.113894   P2: 0x00
2025/04/22 11:37:25.113902   Lc: 0x70 (数据块长度=112)
2025/04/22 11:37:25.113913   Data: 4141414141414141414141414141414141414141...(数据块太长，只显示前20字节)
2025/04/22 11:37:25.139136 
=== 存储数据继续响应 ===
2025/04/22 11:37:25.139226 响应数据: 040200007090009000
2025/04/22 11:37:25.139266 状态码: 0x9000 (成功)
2025/04/22 11:37:25.139340 响应解析:
2025/04/22 11:37:25.139379   记录索引: 0x04 (4)
2025/04/22 11:37:25.139408   当前偏移: 0x0200 (512)
2025/04/22 11:37:25.139433   块大小: 0x0070 (112)
2025/04/22 11:37:25.139456 进度: 512/512 字节 (100.0%)
2025/04/22 11:37:25.139491 
=== 存储完成命令 ===
2025/04/22 11:37:25.139512 APDU: 8012000000
2025/04/22 11:37:25.139532 命令解析:
2025/04/22 11:37:25.139548   CLA: 0x80 (命令类)
2025/04/22 11:37:25.139566   INS: 0x12 (存储完成指令)
2025/04/22 11:37:25.139583   P1: 0x00
2025/04/22 11:37:25.139599   P2: 0x00
2025/04/22 11:37:25.139613   Lc: 0x00 (无数据)
2025/04/22 11:37:25.168606 
=== 存储完成响应 ===
2025/04/22 11:37:25.168681 响应数据: 0402000490009000
2025/04/22 11:37:25.168710 状态码: 0x9000 (成功)
2025/04/22 11:37:25.168730 响应解析:
2025/04/22 11:37:25.168747   记录索引: 0x04 (4)
2025/04/22 11:37:25.168778   最终长度: 0x0200 (512字节)
2025/04/22 11:37:25.168797   新记录总数: 0x04 (4)
2025/04/22 11:37:25.168816 === 存储操作成功完成 ===
2025/04/22 11:37:25.168883 
>> 存储消息 #4: 接近最大长度消息测试(1023字节)
2025/04/22 11:37:25.168973    用户名: User3
2025/04/22 11:37:25.168990    地址: Shenzhen
2025/04/22 11:37:25.169005    消息长度: 1023字节
2025/04/22 11:37:25.169022 
=== 存储初始化命令 ===
2025/04/22 11:37:25.169036 APDU: 801000000F055573657233085368656E7A68656E
2025/04/22 11:37:25.169052 命令解析:
2025/04/22 11:37:25.169064   CLA: 0x80 (命令类)
2025/04/22 11:37:25.169079   INS: 0x10 (存储初始化指令)
2025/04/22 11:37:25.169092   P1: 0x00
2025/04/22 11:37:25.169105   P2: 0x00
2025/04/22 11:37:25.169117   Lc: 0x0F (数据长度=15)
2025/04/22 11:37:25.169130   Data: 055573657233085368656E7A68656E
2025/04/22 11:37:25.169142     用户名长度: 0x05 (5)
2025/04/22 11:37:25.169153     用户名: 5573657233 (User3)
2025/04/22 11:37:25.169167     地址长度: 0x08 (8)
2025/04/22 11:37:25.169179     地址: 5368656E7A68656E (Shenzhen)
2025/04/22 11:37:25.202713 
=== 存储初始化响应 ===
2025/04/22 11:37:25.202750 响应数据: 0505050890009000
2025/04/22 11:37:25.202759 状态码: 0x9000 (成功)
2025/04/22 11:37:25.202765 响应解析:
2025/04/22 11:37:25.202769   记录索引: 0x05 (5)
2025/04/22 11:37:25.202775   当前记录总数: 0x05 (5)
2025/04/22 11:37:25.202779   用户名长度: 0x05 (5)
2025/04/22 11:37:25.202783   地址长度: 0x08 (8)
2025/04/22 11:37:25.202789 
传输消息数据:
2025/04/22 11:37:25.202793 总长度: 1023 字节
2025/04/22 11:37:25.202797 分块大小: 200 字节
2025/04/22 11:37:25.202801 预计分块数: 6
2025/04/22 11:37:25.202812 
=== 存储数据继续命令 (块 1/6) ===
2025/04/22 11:37:25.202818 APDU: 80110000C8424242424242424242424242424242...(显示前20字节)
2025/04/22 11:37:25.202822 命令解析:
2025/04/22 11:37:25.202826   CLA: 0x80 (命令类)
2025/04/22 11:37:25.202830   INS: 0x11 (存储继续指令)
2025/04/22 11:37:25.202834   P1: 0x00
2025/04/22 11:37:25.202838   P2: 0x00
2025/04/22 11:37:25.202842   Lc: 0xC8 (数据块长度=200)
2025/04/22 11:37:25.202846   Data: 4242424242424242424242424242424242424242...(数据块太长，只显示前20字节)
2025/04/22 11:37:25.224910 
=== 存储数据继续响应 ===
2025/04/22 11:37:25.224955 响应数据: 0500C800C890009000
2025/04/22 11:37:25.224997 状态码: 0x9000 (成功)
2025/04/22 11:37:25.225008 响应解析:
2025/04/22 11:37:25.225015   记录索引: 0x05 (5)
2025/04/22 11:37:25.225022   当前偏移: 0x00C8 (200)
2025/04/22 11:37:25.225030   块大小: 0x00C8 (200)
2025/04/22 11:37:25.225037 进度: 200/1023 字节 (19.6%)
2025/04/22 11:37:25.225048 
=== 存储数据继续命令 (块 2/6) ===
2025/04/22 11:37:25.225056 APDU: 80110000C8424242424242424242424242424242...(显示前20字节)
2025/04/22 11:37:25.225062 命令解析:
2025/04/22 11:37:25.225068   CLA: 0x80 (命令类)
2025/04/22 11:37:25.225074   INS: 0x11 (存储继续指令)
2025/04/22 11:37:25.225081   P1: 0x00
2025/04/22 11:37:25.225087   P2: 0x00
2025/04/22 11:37:25.225118   Lc: 0xC8 (数据块长度=200)
2025/04/22 11:37:25.225126   Data: 4242424242424242424242424242424242424242...(数据块太长，只显示前20字节)
2025/04/22 11:37:25.250389 
=== 存储数据继续响应 ===
2025/04/22 11:37:25.250532 响应数据: 05019000C890009000
2025/04/22 11:37:25.250565 状态码: 0x9000 (成功)
2025/04/22 11:37:25.250589 响应解析:
2025/04/22 11:37:25.250604   记录索引: 0x05 (5)
2025/04/22 11:37:25.250619   当前偏移: 0x0190 (400)
2025/04/22 11:37:25.250634   块大小: 0x00C8 (200)
2025/04/22 11:37:25.250647 进度: 400/1023 字节 (39.1%)
2025/04/22 11:37:25.250672 
=== 存储数据继续命令 (块 3/6) ===
2025/04/22 11:37:25.250686 APDU: 80110000C8424242424242424242424242424242...(显示前20字节)
2025/04/22 11:37:25.250699 命令解析:
2025/04/22 11:37:25.250707   CLA: 0x80 (命令类)
2025/04/22 11:37:25.250717   INS: 0x11 (存储继续指令)
2025/04/22 11:37:25.250729   P1: 0x00
2025/04/22 11:37:25.250738   P2: 0x00
2025/04/22 11:37:25.250747   Lc: 0xC8 (数据块长度=200)
2025/04/22 11:37:25.250758   Data: 4242424242424242424242424242424242424242...(数据块太长，只显示前20字节)
2025/04/22 11:37:25.278066 
=== 存储数据继续响应 ===
2025/04/22 11:37:25.278145 响应数据: 05025800C890009000
2025/04/22 11:37:25.278175 状态码: 0x9000 (成功)
2025/04/22 11:37:25.278195 响应解析:
2025/04/22 11:37:25.278211   记录索引: 0x05 (5)
2025/04/22 11:37:25.278228   当前偏移: 0x0258 (600)
2025/04/22 11:37:25.278284   块大小: 0x00C8 (200)
2025/04/22 11:37:25.278304 进度: 600/1023 字节 (58.7%)
2025/04/22 11:37:25.278325 
=== 存储数据继续命令 (块 4/6) ===
2025/04/22 11:37:25.278341 APDU: 80110000C8424242424242424242424242424242...(显示前20字节)
2025/04/22 11:37:25.278354 命令解析:
2025/04/22 11:37:25.278366   CLA: 0x80 (命令类)
2025/04/22 11:37:25.278379   INS: 0x11 (存储继续指令)
2025/04/22 11:37:25.278392   P1: 0x00
2025/04/22 11:37:25.278403   P2: 0x00
2025/04/22 11:37:25.278415   Lc: 0xC8 (数据块长度=200)
2025/04/22 11:37:25.278428   Data: 4242424242424242424242424242424242424242...(数据块太长，只显示前20字节)
2025/04/22 11:37:25.303906 
=== 存储数据继续响应 ===
2025/04/22 11:37:25.303973 响应数据: 05032000C890009000
2025/04/22 11:37:25.304000 状态码: 0x9000 (成功)
2025/04/22 11:37:25.304018 响应解析:
2025/04/22 11:37:25.304119   记录索引: 0x05 (5)
2025/04/22 11:37:25.304143   当前偏移: 0x0320 (800)
2025/04/22 11:37:25.304158   块大小: 0x00C8 (200)
2025/04/22 11:37:25.304172 进度: 800/1023 字节 (78.2%)
2025/04/22 11:37:25.304204 
=== 存储数据继续命令 (块 5/6) ===
2025/04/22 11:37:25.304226 APDU: 80110000C8424242424242424242424242424242...(显示前20字节)
2025/04/22 11:37:25.304242 命令解析:
2025/04/22 11:37:25.304253   CLA: 0x80 (命令类)
2025/04/22 11:37:25.304265   INS: 0x11 (存储继续指令)
2025/04/22 11:37:25.304277   P1: 0x00
2025/04/22 11:37:25.304288   P2: 0x00
2025/04/22 11:37:25.304298   Lc: 0xC8 (数据块长度=200)
2025/04/22 11:37:25.304310   Data: 4242424242424242424242424242424242424242...(数据块太长，只显示前20字节)
2025/04/22 11:37:25.331584 
=== 存储数据继续响应 ===
2025/04/22 11:37:25.331653 响应数据: 0503E800C890009000
2025/04/22 11:37:25.331680 状态码: 0x9000 (成功)
2025/04/22 11:37:25.331700 响应解析:
2025/04/22 11:37:25.331773   记录索引: 0x05 (5)
2025/04/22 11:37:25.331792   当前偏移: 0x03E8 (1000)
2025/04/22 11:37:25.331805   块大小: 0x00C8 (200)
2025/04/22 11:37:25.331819 进度: 1000/1023 字节 (97.8%)
2025/04/22 11:37:25.331838 
=== 存储数据继续命令 (块 6/6) ===
2025/04/22 11:37:25.331851 APDU: 8011000017424242424242424242424242424242...(显示前20字节)
2025/04/22 11:37:25.331863 命令解析:
2025/04/22 11:37:25.331874   CLA: 0x80 (命令类)
2025/04/22 11:37:25.331886   INS: 0x11 (存储继续指令)
2025/04/22 11:37:25.331897   P1: 0x00
2025/04/22 11:37:25.331907   P2: 0x00
2025/04/22 11:37:25.331917   Lc: 0x17 (数据块长度=23)
2025/04/22 11:37:25.331972   Data: 4242424242424242424242424242424242424242...(数据块太长，只显示前20字节)
2025/04/22 11:37:25.355931 
=== 存储数据继续响应 ===
2025/04/22 11:37:25.356014 响应数据: 0503FF001790009000
2025/04/22 11:37:25.356050 状态码: 0x9000 (成功)
2025/04/22 11:37:25.356070 响应解析:
2025/04/22 11:37:25.356089   记录索引: 0x05 (5)
2025/04/22 11:37:25.356109   当前偏移: 0x03FF (1023)
2025/04/22 11:37:25.356123   块大小: 0x0017 (23)
2025/04/22 11:37:25.356136 进度: 1023/1023 字节 (100.0%)
2025/04/22 11:37:25.356154 
=== 存储完成命令 ===
2025/04/22 11:37:25.356217 APDU: 8012000000
2025/04/22 11:37:25.356231 命令解析:
2025/04/22 11:37:25.356241   CLA: 0x80 (命令类)
2025/04/22 11:37:25.356253   INS: 0x12 (存储完成指令)
2025/04/22 11:37:25.356264   P1: 0x00
2025/04/22 11:37:25.356275   P2: 0x00
2025/04/22 11:37:25.356285   Lc: 0x00 (无数据)
2025/04/22 11:37:25.387114 
=== 存储完成响应 ===
2025/04/22 11:37:25.387201 响应数据: 0503FF0590009000
2025/04/22 11:37:25.387237 状态码: 0x9000 (成功)
2025/04/22 11:37:25.387311 响应解析:
2025/04/22 11:37:25.387347   记录索引: 0x05 (5)
2025/04/22 11:37:25.387369   最终长度: 0x03FF (1023字节)
2025/04/22 11:37:25.387388   新记录总数: 0x05 (5)
2025/04/22 11:37:25.387405 === 存储操作成功完成 ===
2025/04/22 11:37:25.387461 
>> 存储消息 #5: 最大长度消息测试(1024字节)
2025/04/22 11:37:25.387485    用户名: User4
2025/04/22 11:37:25.387504    地址: Guangzhou
2025/04/22 11:37:25.387521    消息长度: 1024字节
2025/04/22 11:37:25.387541 
=== 存储初始化命令 ===
2025/04/22 11:37:25.387557 APDU: 8010000010055573657234094775616E677A686F75
2025/04/22 11:37:25.387575 命令解析:
2025/04/22 11:37:25.387589   CLA: 0x80 (命令类)
2025/04/22 11:37:25.387604   INS: 0x10 (存储初始化指令)
2025/04/22 11:37:25.387621   P1: 0x00
2025/04/22 11:37:25.387635   P2: 0x00
2025/04/22 11:37:25.387649   Lc: 0x10 (数据长度=16)
2025/04/22 11:37:25.387665   Data: 055573657234094775616E677A686F75
2025/04/22 11:37:25.387680     用户名长度: 0x05 (5)
2025/04/22 11:37:25.387698     用户名: 5573657234 (User4)
2025/04/22 11:37:25.387715     地址长度: 0x09 (9)
2025/04/22 11:37:25.387732     地址: 4775616E677A686F75 (Guangzhou)
2025/04/22 11:37:25.421567 
=== 存储初始化响应 ===
2025/04/22 11:37:25.421648 响应数据: 0606050990009000
2025/04/22 11:37:25.421681 状态码: 0x9000 (成功)
2025/04/22 11:37:25.421703 响应解析:
2025/04/22 11:37:25.421721   记录索引: 0x06 (6)
2025/04/22 11:37:25.421736   当前记录总数: 0x06 (6)
2025/04/22 11:37:25.421750   用户名长度: 0x05 (5)
2025/04/22 11:37:25.421763   地址长度: 0x09 (9)
2025/04/22 11:37:25.421781 
传输消息数据:
2025/04/22 11:37:25.421792 总长度: 1024 字节
2025/04/22 11:37:25.421804 分块大小: 200 字节
2025/04/22 11:37:25.421816 预计分块数: 6
2025/04/22 11:37:25.421829 
=== 存储数据继续命令 (块 1/6) ===
2025/04/22 11:37:25.421842 APDU: 80110000C8434343434343434343434343434343...(显示前20字节)
2025/04/22 11:37:25.421854 命令解析:
2025/04/22 11:37:25.421863   CLA: 0x80 (命令类)
2025/04/22 11:37:25.421875   INS: 0x11 (存储继续指令)
2025/04/22 11:37:25.421887   P1: 0x00
2025/04/22 11:37:25.421952   P2: 0x00
2025/04/22 11:37:25.421967   Lc: 0xC8 (数据块长度=200)
2025/04/22 11:37:25.421983   Data: 4343434343434343434343434343434343434343...(数据块太长，只显示前20字节)
2025/04/22 11:37:25.445705 
=== 存储数据继续响应 ===
2025/04/22 11:37:25.445826 响应数据: 0600C800C890009000
2025/04/22 11:37:25.445858 状态码: 0x9000 (成功)
2025/04/22 11:37:25.445880 响应解析:
2025/04/22 11:37:25.445894   记录索引: 0x06 (6)
2025/04/22 11:37:25.445909   当前偏移: 0x00C8 (200)
2025/04/22 11:37:25.445921   块大小: 0x00C8 (200)
2025/04/22 11:37:25.445938 进度: 200/1024 字节 (19.5%)
2025/04/22 11:37:25.445959 
=== 存储数据继续命令 (块 2/6) ===
2025/04/22 11:37:25.445972 APDU: 80110000C8434343434343434343434343434343...(显示前20字节)
2025/04/22 11:37:25.446022 命令解析:
2025/04/22 11:37:25.446034   CLA: 0x80 (命令类)
2025/04/22 11:37:25.446046   INS: 0x11 (存储继续指令)
2025/04/22 11:37:25.446057   P1: 0x00
2025/04/22 11:37:25.446067   P2: 0x00
2025/04/22 11:37:25.446077   Lc: 0xC8 (数据块长度=200)
2025/04/22 11:37:25.446087   Data: 4343434343434343434343434343434343434343...(数据块太长，只显示前20字节)
2025/04/22 11:37:25.471584 
=== 存储数据继续响应 ===
2025/04/22 11:37:25.471701 响应数据: 06019000C890009000
2025/04/22 11:37:25.471725 状态码: 0x9000 (成功)
2025/04/22 11:37:25.471745 响应解析:
2025/04/22 11:37:25.471760   记录索引: 0x06 (6)
2025/04/22 11:37:25.471776   当前偏移: 0x0190 (400)
2025/04/22 11:37:25.471790   块大小: 0x00C8 (200)
2025/04/22 11:37:25.471806 进度: 400/1024 字节 (39.1%)
2025/04/22 11:37:25.471830 
=== 存储数据继续命令 (块 3/6) ===
2025/04/22 11:37:25.471844 APDU: 80110000C8434343434343434343434343434343...(显示前20字节)
2025/04/22 11:37:25.471858 命令解析:
2025/04/22 11:37:25.471870   CLA: 0x80 (命令类)
2025/04/22 11:37:25.471884   INS: 0x11 (存储继续指令)
2025/04/22 11:37:25.471897   P1: 0x00
2025/04/22 11:37:25.471909   P2: 0x00
2025/04/22 11:37:25.471922   Lc: 0xC8 (数据块长度=200)
2025/04/22 11:37:25.471935   Data: 4343434343434343434343434343434343434343...(数据块太长，只显示前20字节)
2025/04/22 11:37:25.503155 
=== 存储数据继续响应 ===
2025/04/22 11:37:25.503222 响应数据: 06025800C890009000
2025/04/22 11:37:25.503252 状态码: 0x9000 (成功)
2025/04/22 11:37:25.503270 响应解析:
2025/04/22 11:37:25.503286   记录索引: 0x06 (6)
2025/04/22 11:37:25.503303   当前偏移: 0x0258 (600)
2025/04/22 11:37:25.503317   块大小: 0x00C8 (200)
2025/04/22 11:37:25.503332 进度: 600/1024 字节 (58.6%)
2025/04/22 11:37:25.503352 
=== 存储数据继续命令 (块 4/6) ===
2025/04/22 11:37:25.503366 APDU: 80110000C8434343434343434343434343434343...(显示前20字节)
2025/04/22 11:37:25.503380 命令解析:
2025/04/22 11:37:25.503392   CLA: 0x80 (命令类)
2025/04/22 11:37:25.503404   INS: 0x11 (存储继续指令)
2025/04/22 11:37:25.503416   P1: 0x00
2025/04/22 11:37:25.503428   P2: 0x00
2025/04/22 11:37:25.503439   Lc: 0xC8 (数据块长度=200)
2025/04/22 11:37:25.503452   Data: 4343434343434343434343434343434343434343...(数据块太长，只显示前20字节)
2025/04/22 11:37:25.529833 
=== 存储数据继续响应 ===
2025/04/22 11:37:25.529874 响应数据: 06032000C890009000
2025/04/22 11:37:25.529890 状态码: 0x9000 (成功)
2025/04/22 11:37:25.529903 响应解析:
2025/04/22 11:37:25.529914   记录索引: 0x06 (6)
2025/04/22 11:37:25.529925   当前偏移: 0x0320 (800)
2025/04/22 11:37:25.529936   块大小: 0x00C8 (200)
2025/04/22 11:37:25.529948 进度: 800/1024 字节 (78.1%)
2025/04/22 11:37:25.529964 
=== 存储数据继续命令 (块 5/6) ===
2025/04/22 11:37:25.529977 APDU: 80110000C8434343434343434343434343434343...(显示前20字节)
2025/04/22 11:37:25.529988 命令解析:
2025/04/22 11:37:25.529997   CLA: 0x80 (命令类)
2025/04/22 11:37:25.530007   INS: 0x11 (存储继续指令)
2025/04/22 11:37:25.530018   P1: 0x00
2025/04/22 11:37:25.530027   P2: 0x00
2025/04/22 11:37:25.530037   Lc: 0xC8 (数据块长度=200)
2025/04/22 11:37:25.530048   Data: 4343434343434343434343434343434343434343...(数据块太长，只显示前20字节)
2025/04/22 11:37:25.558216 
=== 存储数据继续响应 ===
2025/04/22 11:37:25.558299 响应数据: 0603E800C890009000
2025/04/22 11:37:25.558331 状态码: 0x9000 (成功)
2025/04/22 11:37:25.558350 响应解析:
2025/04/22 11:37:25.558365   记录索引: 0x06 (6)
2025/04/22 11:37:25.558380   当前偏移: 0x03E8 (1000)
2025/04/22 11:37:25.558393   块大小: 0x00C8 (200)
2025/04/22 11:37:25.558409 进度: 1000/1024 字节 (97.7%)
2025/04/22 11:37:25.558428 
=== 存储数据继续命令 (块 6/6) ===
2025/04/22 11:37:25.558442 APDU: 8011000018434343434343434343434343434343...(显示前20字节)
2025/04/22 11:37:25.558486 命令解析:
2025/04/22 11:37:25.558500   CLA: 0x80 (命令类)
2025/04/22 11:37:25.558512   INS: 0x11 (存储继续指令)
2025/04/22 11:37:25.558524   P1: 0x00
2025/04/22 11:37:25.558535   P2: 0x00
2025/04/22 11:37:25.558545   Lc: 0x18 (数据块长度=24)
2025/04/22 11:37:25.558557   Data: 4343434343434343434343434343434343434343...(数据块太长，只显示前20字节)
2025/04/22 11:37:25.581568 
=== 存储数据继续响应 ===
2025/04/22 11:37:25.581649 响应数据: 060400001890009000
2025/04/22 11:37:25.581679 状态码: 0x9000 (成功)
2025/04/22 11:37:25.581699 响应解析:
2025/04/22 11:37:25.581775   记录索引: 0x06 (6)
2025/04/22 11:37:25.581794   当前偏移: 0x0400 (1024)
2025/04/22 11:37:25.581810   块大小: 0x0018 (24)
2025/04/22 11:37:25.581827 进度: 1024/1024 字节 (100.0%)
2025/04/22 11:37:25.581849 
=== 存储完成命令 ===
2025/04/22 11:37:25.581864 APDU: 8012000000
2025/04/22 11:37:25.581879 命令解析:
2025/04/22 11:37:25.581893   CLA: 0x80 (命令类)
2025/04/22 11:37:25.581906   INS: 0x12 (存储完成指令)
2025/04/22 11:37:25.581920   P1: 0x00
2025/04/22 11:37:25.581934   P2: 0x00
2025/04/22 11:37:25.581947   Lc: 0x00 (无数据)
2025/04/22 11:37:25.611710 
=== 存储完成响应 ===
2025/04/22 11:37:25.611775 响应数据: 0604000690009000
2025/04/22 11:37:25.611801 状态码: 0x9000 (成功)
2025/04/22 11:37:25.611820 响应解析:
2025/04/22 11:37:25.611833   记录索引: 0x06 (6)
2025/04/22 11:37:25.611849   最终长度: 0x0400 (1024字节)
2025/04/22 11:37:25.611889   新记录总数: 0x06 (6)
2025/04/22 11:37:25.611911 === 存储操作成功完成 ===
2025/04/22 11:37:25.611959 

=== 测试2: 读取所有消息 ===
2025/04/22 11:37:25.612048 
>> 读取消息 #1: 基本消息测试
2025/04/22 11:37:25.612080    用户名: User1
2025/04/22 11:37:25.612097    地址: Beijing Haidian
2025/04/22 11:37:25.612115 
=== 读取初始化命令 ===
2025/04/22 11:37:25.612130 APDU: 80200000170555736572310F4265696A696E67204861696469616E0002
2025/04/22 11:37:25.612146 命令解析:
2025/04/22 11:37:25.612159   CLA: 0x80 (命令类)
2025/04/22 11:37:25.612173   INS: 0x20 (读取初始化指令)
2025/04/22 11:37:25.612186   P1: 0x00
2025/04/22 11:37:25.612199   P2: 0x00
2025/04/22 11:37:25.612212   Lc: 0x17 (数据长度=23)
2025/04/22 11:37:25.612226   Data: 0555736572310F4265696A696E67204861696469616E00
2025/04/22 11:37:25.612239     用户名长度: 0x05 (5)
2025/04/22 11:37:25.612253     用户名: 5573657231 (User1)
2025/04/22 11:37:25.612267     地址长度: 0x0F (15)
2025/04/22 11:37:25.612279     地址: 4265696A696E67204861696469616E (Beijing Haidian)
2025/04/22 11:37:25.612294     签名长度: 0x00 (0)
2025/04/22 11:37:25.612306   Le: 0x02 (期望返回2字节消息长度)
2025/04/22 11:37:25.649957 
=== 读取初始化响应 ===
2025/04/22 11:37:25.650037 响应数据: 00519000
2025/04/22 11:37:25.650068 状态码: 0x9000 (成功)
2025/04/22 11:37:25.650090 响应解析:
2025/04/22 11:37:25.650110   消息总长度: 0x0051 (81字节)
2025/04/22 11:37:25.650125 消息总长度: 81 字节
2025/04/22 11:37:25.650186 
=== 开始读取消息数据 ===
2025/04/22 11:37:25.650212 预期总长度: 81 字节
2025/04/22 11:37:25.650225 
=== 读取数据继续命令 (第1次) ===
2025/04/22 11:37:25.650237 APDU: 8021000051
2025/04/22 11:37:25.650249 命令解析:
2025/04/22 11:37:25.650258   CLA: 0x80 (命令类)
2025/04/22 11:37:25.650269   INS: 0x21 (读取继续指令)
2025/04/22 11:37:25.650279   P1: 0x00
2025/04/22 11:37:25.650288   P2: 0x00
2025/04/22 11:37:25.650297   Le: 0x51 (期望读取81字节)
2025/04/22 11:37:25.661911 
=== 读取数据继续响应 ===
2025/04/22 11:37:25.661974 响应数据: 5468697320697320746865206669727374207465...(显示前20字节)
2025/04/22 11:37:25.661993 状态码: 0x9000
2025/04/22 11:37:25.662008 解析响应: 数据块大小=81字节, 状态=读取完成
2025/04/22 11:37:25.662024 进度: 81/81 字节 (100.0%)
2025/04/22 11:37:25.662041 数据读取完成，总计读取: 81 字节
2025/04/22 11:37:25.662053 
=== 读取完成命令 ===
2025/04/22 11:37:25.662103 APDU: 8022000000
2025/04/22 11:37:25.662117 命令解析:
2025/04/22 11:37:25.662126   CLA: 0x80 (命令类)
2025/04/22 11:37:25.662137   INS: 0x22 (读取完成指令)
2025/04/22 11:37:25.662146   P1: 0x00
2025/04/22 11:37:25.662155   P2: 0x00
2025/04/22 11:37:25.662163   Lc: 0x00 (无数据)
2025/04/22 11:37:25.676426 
=== 读取完成响应 ===
2025/04/22 11:37:25.676500 响应数据: 00FF90009000
2025/04/22 11:37:25.676524 状态码: 0x9000
2025/04/22 11:37:25.676542 响应解析:
2025/04/22 11:37:25.676554   操作状态: 0x00
2025/04/22 11:37:25.676566   记录索引: 0xFF (255)
2025/04/22 11:37:25.676579 === 读取操作成功完成 ===
2025/04/22 11:37:25.676710    读取成功: 81字节
2025/04/22 11:37:25.676757    原始消息长度: 81字节
2025/04/22 11:37:25.676775    消息验证: 验证通过 - 内容完全匹配
2025/04/22 11:37:25.676800 
>> 读取消息 #2: 相同用户名和地址的覆盖测试
2025/04/22 11:37:25.676813    用户名: User1
2025/04/22 11:37:25.676825    地址: Beijing Haidian
2025/04/22 11:37:25.676844 
=== 读取初始化命令 ===
2025/04/22 11:37:25.676858 APDU: 80200000170555736572310F4265696A696E67204861696469616E0002
2025/04/22 11:37:25.676869 命令解析:
2025/04/22 11:37:25.676878   CLA: 0x80 (命令类)
2025/04/22 11:37:25.676889   INS: 0x20 (读取初始化指令)
2025/04/22 11:37:25.676899   P1: 0x00
2025/04/22 11:37:25.676907   P2: 0x00
2025/04/22 11:37:25.676917   Lc: 0x17 (数据长度=23)
2025/04/22 11:37:25.676926   Data: 0555736572310F4265696A696E67204861696469616E00
2025/04/22 11:37:25.676935     用户名长度: 0x05 (5)
2025/04/22 11:37:25.676943     用户名: 5573657231 (User1)
2025/04/22 11:37:25.676952     地址长度: 0x0F (15)
2025/04/22 11:37:25.676960     地址: 4265696A696E67204861696469616E (Beijing Haidian)
2025/04/22 11:37:25.676967     签名长度: 0x00 (0)
2025/04/22 11:37:25.676975   Le: 0x02 (期望返回2字节消息长度)
2025/04/22 11:37:25.714707 
=== 读取初始化响应 ===
2025/04/22 11:37:25.714845 响应数据: 00519000
2025/04/22 11:37:25.714887 状态码: 0x9000 (成功)
2025/04/22 11:37:25.714918 响应解析:
2025/04/22 11:37:25.714936   消息总长度: 0x0051 (81字节)
2025/04/22 11:37:25.714956 消息总长度: 81 字节
2025/04/22 11:37:25.714971 
=== 开始读取消息数据 ===
2025/04/22 11:37:25.714986 预期总长度: 81 字节
2025/04/22 11:37:25.715004 
=== 读取数据继续命令 (第1次) ===
2025/04/22 11:37:25.715019 APDU: 8021000051
2025/04/22 11:37:25.715034 命令解析:
2025/04/22 11:37:25.715046   CLA: 0x80 (命令类)
2025/04/22 11:37:25.715058   INS: 0x21 (读取继续指令)
2025/04/22 11:37:25.715070   P1: 0x00
2025/04/22 11:37:25.715080   P2: 0x00
2025/04/22 11:37:25.715089   Le: 0x51 (期望读取81字节)
2025/04/22 11:37:25.726732 
=== 读取数据继续响应 ===
2025/04/22 11:37:25.726795 响应数据: 5468697320697320746865206669727374207465...(显示前20字节)
2025/04/22 11:37:25.726816 状态码: 0x9000
2025/04/22 11:37:25.726830 解析响应: 数据块大小=81字节, 状态=读取完成
2025/04/22 11:37:25.726841 进度: 81/81 字节 (100.0%)
2025/04/22 11:37:25.726857 数据读取完成，总计读取: 81 字节
2025/04/22 11:37:25.726869 
=== 读取完成命令 ===
2025/04/22 11:37:25.726880 APDU: 8022000000
2025/04/22 11:37:25.726890 命令解析:
2025/04/22 11:37:25.726898   CLA: 0x80 (命令类)
2025/04/22 11:37:25.726906   INS: 0x22 (读取完成指令)
2025/04/22 11:37:25.726914   P1: 0x00
2025/04/22 11:37:25.726920   P2: 0x00
2025/04/22 11:37:25.726927   Lc: 0x00 (无数据)
2025/04/22 11:37:25.741063 
=== 读取完成响应 ===
2025/04/22 11:37:25.741140 响应数据: 00FF90009000
2025/04/22 11:37:25.741167 状态码: 0x9000
2025/04/22 11:37:25.741185 响应解析:
2025/04/22 11:37:25.741200   操作状态: 0x00
2025/04/22 11:37:25.741212   记录索引: 0xFF (255)
2025/04/22 11:37:25.741225 === 读取操作成功完成 ===
2025/04/22 11:37:25.741260    读取成功: 81字节
2025/04/22 11:37:25.741278    原始消息长度: 73字节
2025/04/22 11:37:25.741331    消息验证: 验证失败 - 内容不匹配
2025/04/22 11:37:25.741355    错误: 消息内容不匹配!
2025/04/22 11:37:25.741369    原始消息 (前50字节): This is a different message for the same user to t
2025/04/22 11:37:25.741380    读取消息 (前50字节): This is the first test message to verify the stora
2025/04/22 11:37:25.741393    第一个不同位置: 索引=8, 原始=61, 读取=74
2025/04/22 11:37:25.741448 
>> 读取消息 #3: 中等长度消息测试(512字节)
2025/04/22 11:37:25.741491    用户名: User2
2025/04/22 11:37:25.741508    地址: Shanghai Pudong
2025/04/22 11:37:25.741523 
=== 读取初始化命令 ===
2025/04/22 11:37:25.741535 APDU: 80200000170555736572320F5368616E67686169205075646F6E670002
2025/04/22 11:37:25.741546 命令解析:
2025/04/22 11:37:25.741554   CLA: 0x80 (命令类)
2025/04/22 11:37:25.741565   INS: 0x20 (读取初始化指令)
2025/04/22 11:37:25.741574   P1: 0x00
2025/04/22 11:37:25.741581   P2: 0x00
2025/04/22 11:37:25.741588   Lc: 0x17 (数据长度=23)
2025/04/22 11:37:25.741596   Data: 0555736572320F5368616E67686169205075646F6E6700
2025/04/22 11:37:25.741604     用户名长度: 0x05 (5)
2025/04/22 11:37:25.741611     用户名: 5573657232 (User2)
2025/04/22 11:37:25.741617     地址长度: 0x0F (15)
2025/04/22 11:37:25.741624     地址: 5368616E67686169205075646F6E67 (Shanghai Pudong)
2025/04/22 11:37:25.741631     签名长度: 0x00 (0)
2025/04/22 11:37:25.741638   Le: 0x02 (期望返回2字节消息长度)
2025/04/22 11:37:25.779244 
=== 读取初始化响应 ===
2025/04/22 11:37:25.779340 响应数据: 006B9000
2025/04/22 11:37:25.779376 状态码: 0x9000 (成功)
2025/04/22 11:37:25.779397 响应解析:
2025/04/22 11:37:25.779412   消息总长度: 0x006B (107字节)
2025/04/22 11:37:25.779427 消息总长度: 107 字节
2025/04/22 11:37:25.779473 
=== 开始读取消息数据 ===
2025/04/22 11:37:25.779525 预期总长度: 107 字节
2025/04/22 11:37:25.779544 
=== 读取数据继续命令 (第1次) ===
2025/04/22 11:37:25.779559 APDU: 802100006B
2025/04/22 11:37:25.779573 命令解析:
2025/04/22 11:37:25.779582   CLA: 0x80 (命令类)
2025/04/22 11:37:25.779594   INS: 0x21 (读取继续指令)
2025/04/22 11:37:25.779605   P1: 0x00
2025/04/22 11:37:25.779615   P2: 0x00
2025/04/22 11:37:25.779623   Le: 0x6B (期望读取107字节)
2025/04/22 11:37:25.791404 
=== 读取数据继续响应 ===
2025/04/22 11:37:25.791487 响应数据: 5468697320697320746865207365636F6E642074...(显示前20字节)
2025/04/22 11:37:25.791511 状态码: 0x9000
2025/04/22 11:37:25.791529 解析响应: 数据块大小=107字节, 状态=读取完成
2025/04/22 11:37:25.791543 进度: 107/107 字节 (100.0%)
2025/04/22 11:37:25.791563 数据读取完成，总计读取: 107 字节
2025/04/22 11:37:25.791577 
=== 读取完成命令 ===
2025/04/22 11:37:25.791590 APDU: 8022000000
2025/04/22 11:37:25.791602 命令解析:
2025/04/22 11:37:25.791612   CLA: 0x80 (命令类)
2025/04/22 11:37:25.791624   INS: 0x22 (读取完成指令)
2025/04/22 11:37:25.791636   P1: 0x00
2025/04/22 11:37:25.791646   P2: 0x00
2025/04/22 11:37:25.791659   Lc: 0x00 (无数据)
2025/04/22 11:37:25.807126 
=== 读取完成响应 ===
2025/04/22 11:37:25.807208 响应数据: 00FF90009000
2025/04/22 11:37:25.807236 状态码: 0x9000
2025/04/22 11:37:25.807256 响应解析:
2025/04/22 11:37:25.807271   操作状态: 0x00
2025/04/22 11:37:25.807286   记录索引: 0xFF (255)
2025/04/22 11:37:25.807300 === 读取操作成功完成 ===
2025/04/22 11:37:25.807379    读取成功: 107字节
2025/04/22 11:37:25.807405    原始消息长度: 512字节
2025/04/22 11:37:25.807419    消息验证: 验证失败 - 内容不匹配
2025/04/22 11:37:25.807438    错误: 消息内容不匹配!
2025/04/22 11:37:25.807450    原始消息 (前50字节): AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
2025/04/22 11:37:25.807464    读取消息 (前50字节): This is the second test message with a different l
2025/04/22 11:37:25.807477    第一个不同位置: 索引=0, 原始=41, 读取=54
2025/04/22 11:37:25.807544 
>> 读取消息 #4: 接近最大长度消息测试(1023字节)
2025/04/22 11:37:25.807562    用户名: User3
2025/04/22 11:37:25.807577    地址: Shenzhen
2025/04/22 11:37:25.807595 
=== 读取初始化命令 ===
2025/04/22 11:37:25.807607 APDU: 8020000010055573657233085368656E7A68656E0002
2025/04/22 11:37:25.807618 命令解析:
2025/04/22 11:37:25.807628   CLA: 0x80 (命令类)
2025/04/22 11:37:25.807638   INS: 0x20 (读取初始化指令)
2025/04/22 11:37:25.807653   P1: 0x00
2025/04/22 11:37:25.807665   P2: 0x00
2025/04/22 11:37:25.807674   Lc: 0x10 (数据长度=16)
2025/04/22 11:37:25.807685   Data: 055573657233085368656E7A68656E00
2025/04/22 11:37:25.807698     用户名长度: 0x05 (5)
2025/04/22 11:37:25.807710     用户名: 5573657233 (User3)
2025/04/22 11:37:25.807719     地址长度: 0x08 (8)
2025/04/22 11:37:25.807728     地址: 5368656E7A68656E (Shenzhen)
2025/04/22 11:37:25.807737     签名长度: 0x00 (0)
2025/04/22 11:37:25.807746   Le: 0x02 (期望返回2字节消息长度)
2025/04/22 11:37:25.845293 
=== 读取初始化响应 ===
2025/04/22 11:37:25.845428 响应数据: 03FF9000
2025/04/22 11:37:25.845461 状态码: 0x9000 (成功)
2025/04/22 11:37:25.845479 响应解析:
2025/04/22 11:37:25.845490   消息总长度: 0x03FF (1023字节)
2025/04/22 11:37:25.845503 消息总长度: 1023 字节
2025/04/22 11:37:25.845542 
=== 开始读取消息数据 ===
2025/04/22 11:37:25.845560 预期总长度: 1023 字节
2025/04/22 11:37:25.845572 
=== 读取数据继续命令 (第1次) ===
2025/04/22 11:37:25.845582 APDU: 80210000F0
2025/04/22 11:37:25.845593 命令解析:
2025/04/22 11:37:25.845601   CLA: 0x80 (命令类)
2025/04/22 11:37:25.845610   INS: 0x21 (读取继续指令)
2025/04/22 11:37:25.845620   P1: 0x00
2025/04/22 11:37:25.845629   P2: 0x00
2025/04/22 11:37:25.845638   Le: 0xF0 (期望读取240字节)
2025/04/22 11:37:25.851604 
=== 读取数据继续响应 ===
2025/04/22 11:37:25.851626 响应数据: 4242424242424242424242424242424242424242...(显示前20字节)
2025/04/22 11:37:25.851633 状态码: 0xFFFF
2025/04/22 11:37:25.851664    读取失败: 读取数据失败: 读取数据返回错误状态码: 0xFFFF
2025/04/22 11:37:25.851676 
>> 读取消息 #5: 最大长度消息测试(1024字节)
2025/04/22 11:37:25.851681    用户名: User4
2025/04/22 11:37:25.851685    地址: Guangzhou
2025/04/22 11:37:25.851690 
=== 读取初始化命令 ===
2025/04/22 11:37:25.851694 APDU: 8020000011055573657234094775616E677A686F750002
2025/04/22 11:37:25.851699 命令解析:
2025/04/22 11:37:25.851703   CLA: 0x80 (命令类)
2025/04/22 11:37:25.851707   INS: 0x20 (读取初始化指令)
2025/04/22 11:37:25.851711   P1: 0x00
2025/04/22 11:37:25.851714   P2: 0x00
2025/04/22 11:37:25.851718   Lc: 0x11 (数据长度=17)
2025/04/22 11:37:25.851723   Data: 055573657234094775616E677A686F7500
2025/04/22 11:37:25.851727     用户名长度: 0x05 (5)
2025/04/22 11:37:25.851731     用户名: 5573657234 (User4)
2025/04/22 11:37:25.851736     地址长度: 0x09 (9)
2025/04/22 11:37:25.851740     地址: 4775616E677A686F75 (Guangzhou)
2025/04/22 11:37:25.851744     签名长度: 0x00 (0)
2025/04/22 11:37:25.851748   Le: 0x02 (期望返回2字节消息长度)
2025/04/22 11:37:25.854406    读取失败: 读取初始化失败: 读取初始化返回错误状态码: 0x6985
2025/04/22 11:37:25.854468 

=== 测试3: 重复用户和地址覆盖测试 ===
2025/04/22 11:37:25.854488 
>> 存储覆盖消息
2025/04/22 11:37:25.854492    用户名: User1
2025/04/22 11:37:25.854496    地址: Beijing Haidian
2025/04/22 11:37:25.854501    原消息长度: 81字节
2025/04/22 11:37:25.854505    新消息长度: 169字节
2025/04/22 11:37:25.854510    新消息: 这是一条新消息，用于测试对相同用户名和地址的记录进行覆盖。这条消息应该覆盖之前存储的第一条测试消息。2025-04-22 11:37:25
2025/04/22 11:37:25.854525 
=== 存储初始化命令 ===
2025/04/22 11:37:25.854533 APDU: 80100000160555736572310F4265696A696E67204861696469616E
2025/04/22 11:37:25.854537 命令解析:
2025/04/22 11:37:25.854567   CLA: 0x80 (命令类)
2025/04/22 11:37:25.854571   INS: 0x10 (存储初始化指令)
2025/04/22 11:37:25.854575   P1: 0x00
2025/04/22 11:37:25.854578   P2: 0x00
2025/04/22 11:37:25.854581   Lc: 0x16 (数据长度=22)
2025/04/22 11:37:25.854585   Data: 0555736572310F4265696A696E67204861696469616E
2025/04/22 11:37:25.854589     用户名长度: 0x05 (5)
2025/04/22 11:37:25.854592     用户名: 5573657231 (User1)
2025/04/22 11:37:25.854596     地址长度: 0x0F (15)
2025/04/22 11:37:25.854600     地址: 4265696A696E67204861696469616E (Beijing Haidian)
2025/04/22 11:37:25.856945    存储失败: 存储初始化失败: 存储初始化返回错误状态码: 0x6985
2025/04/22 11:37:25.857008 
=== 安全芯片Applet测试完成 - 2025-04-22 11:37:25 ===
